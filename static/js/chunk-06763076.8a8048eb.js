(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06763076"],{"972a":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e._self._c;return a("div",{staticClass:"main-container",staticStyle:{"font-family":"等线"}},[a("div",{staticClass:"content-wrapper margin-top"},[a("el-card",{attrs:{"body-style":{padding:0},shadow:"hover"}},[a("div",{staticClass:"flex justify-between padding-sm solid-bottom"},[a("el-link",{attrs:{underline:!1}},[e._v("基本信息")])],1),a("el-form",{staticClass:"form-wrapper",attrs:{"label-width":"80px",size:"small","label-position":"right"},model:{value:e.baseInfoModel,callback:function(a){e.baseInfoModel=a},expression:"baseInfoModel"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"头像"}},[a("el-avatar",{attrs:{size:100,src:e.personalInformation.avatar}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{limit:5,action:"","http-request":e.changeFile,"show-file-list":!1}},[a("el-button",{attrs:{icon:"el-icon-upload",type:"primary"}},[e._v("修改头像")])],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.personalInformation.username,callback:function(a){e.$set(e.personalInformation,"username",a)},expression:"personalInformation.username"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"真实姓名"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.personalInformation.real_name,callback:function(a){e.$set(e.personalInformation,"real_name",a)},expression:"personalInformation.real_name"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"ID"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.personalInformation.user_id,callback:function(a){e.$set(e.personalInformation,"user_id",a)},expression:"personalInformation.user_id"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.personalInformation.email,callback:function(a){e.$set(e.personalInformation,"email",a)},expression:"personalInformation.email"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.baseInfoModel.password,callback:function(a){e.$set(e.baseInfoModel,"password",a)},expression:"baseInfoModel.password"}}),a("el-button",{attrs:{size:"mini",type:"Placeholder",underline:!1},on:{click:function(a){e.dialogVisible_changePassword=!0}}},[e._v("修改")]),a("el-dialog",{attrs:{title:"修改密码",visible:e.dialogVisible_changePassword,width:"40%",center:""},on:{"update:visible":function(a){e.dialogVisible_changePassword=a}}},[a("el-form",{attrs:{model:e.form_changePassword}},[a("el-form-item",{attrs:{label:"原密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",type:"password"},model:{value:e.form_changePassword.old_password,callback:function(a){e.$set(e.form_changePassword,"old_password",a)},expression:"form_changePassword.old_password"}})],1),a("el-form-item",{attrs:{label:"新密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",type:"password"},model:{value:e.form_changePassword.password1,callback:function(a){e.$set(e.form_changePassword,"password1",a)},expression:"form_changePassword.password1"}})],1),a("el-form-item",{attrs:{label:"确认密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",type:"password"},model:{value:e.form_changePassword.password2,callback:function(a){e.$set(e.form_changePassword,"password2",a)},expression:"form_changePassword.password2"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(a){e.dialogVisible_changePassword=!1,e.clearPassword()}}},[e._v("取 消")]),a("el-button",{on:{click:function(a){e.changePassword(),e.dialogVisible_changePassword=!1,e.clearPassword()}}},[e._v("确 定")])],1)],1)],1)],1),a("el-button",{staticClass:"button-style",attrs:{icon:"el-icon-upload",type:"primary"},on:{click:function(a){e.dialogVisiblechange=!0}}},[e._v(" 修改个人信息 ")]),a("el-dialog",{attrs:{title:"修改个人信息",visible:e.dialogVisiblechange,width:"40%",center:""},on:{"update:visible":function(a){e.dialogVisiblechange=a}}},[a("el-form",{attrs:{model:e.baseInfoModel}},[a("el-form-item",{attrs:{label:"名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.baseInfoModel.username,callback:function(a){e.$set(e.baseInfoModel,"username",a)},expression:"baseInfoModel.username"}})],1),a("el-form-item",{attrs:{label:"真实姓名","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.baseInfoModel.real_name,callback:function(a){e.$set(e.baseInfoModel,"real_name",a)},expression:"baseInfoModel.real_name"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(a){e.dialogVisiblechange=!1,e.clearPassword()}}},[e._v("取 消")]),a("el-button",{on:{click:function(a){e.changePersonal(),e.dialogVisiblechange=!1,e.clearPassword()}}},[e._v("确 定")])],1)],1)],1)],1)],1)])},o=[],n=(t("d3b7"),t("3ca3"),t("ddb0"),t("2b3d"),t("9861"),t("4328")),r=t.n(n),l=t("0f9a"),i=t("8159"),d={name:"Personal",data:function(){return{dialogVisible_changePassword:!1,dialogVisiblechange:!1,loading:!1,file:"",Token:l["getters"].getToken(l["state"]),personalInformation:{username:null,email:null,sex:null,avatar:null,user_id:null},form_getPersonalInformation:{authorization:l["getters"].getToken(l["state"]),username:l["getters"].getUserName(l["state"])},form_deleteUser:{token:l["getters"].getToken(l["state"]),username:l["getters"].getUserName(l["state"]),user_id:l["getters"].getUserId(l["state"]),password:""},form_changePassword:{mode:1,token:l["getters"].getToken(l["state"]),user_id:l["getters"].getUserId(l["state"]),old_password:null,password1:null,password2:null},imageUrl:"",baseInfoModel:{username:"",id:"",real_name:"",email:"",password:""},formLabelWidth:180}},created:function(){this.getPersonalInformation()},methods:{changePerson:function(){var e=this;this.$axios.post("/user/modifyUserInfo",r.a.stringify(this.baseInfoModel)).then((function(a){a.data.success?(e.$message.success(a.data.message),e.getPersonalInformation(),location.reload()):e.$message.error(a.data.message)}))},changeFile:function(e){var a=this;console.log("file",e);var t=new FormData;t.append("file",e.file),t.append("token",l["getters"].getToken(l["state"])),this.$axios("/user/uploadFile",{method:"POST",headers:{"Content-Type":"multipart/form-data"},data:t}).then((function(e){e.data.success&&a.$axios.post("/user/modifyUserInfo",r.a.stringify({token:l["getters"].getToken(l["state"]),avatar:e.data.data[0].url})).then((function(e){e.data.success?(a.$message.success(e.data.message),location.reload()):a.$message.error(e.data.message),a.getPersonalInformation(),l["getters"].changeAvatar(l["state"],a.personalInformation.avatar)}))}))},beforeUpload:function(e){var a="image/jpeg"===e.type,t=e.size/1024/1024<10;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 10MB!"),a&&t},clearPassword:function(){this.form_changePassword.old_password="",this.form_changePassword.password1="",this.form_changePassword.password2=""},logOff_1:function(){var e=this;this.$confirm("此操作将删除此账户,请确定是否是用户本人操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.logOff_2()})).catch((function(){e.$message({type:"info",message:"已取消注销"})}))},logOff_2:function(){var e=this;this.$confirm("此操作将彻底删除此账户,并且会删除所有个人文件，退出所有团队，是否继续?(注意，如果有身为队长的团队则无法继续注销）","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.logOff_3()})).catch((function(){e.$message({type:"info",message:"已取消注销"})}))},logOff_3:function(){var e=this;this.$confirm("真的要离开我们吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.logOff()})).catch((function(){e.$message({type:"info",message:"已取消注销"})}))},deleteUser:function(){var e=this;this.$axios.post("/user/delete_user",r.a.stringify(this.form_deleteUser)).then((function(a){3===a.data.result?(e.$message.success("非常感谢您对墨书的支持，希望下次再会!"),i["a"].logout(),i["a"].onLogout&&i["a"].onLogout()):e.$message.error(a.data.message)}))},getPersonalInformation:function(){var e=this;this.loading=!0,this.$axios.get("/user/selectUserByUserId",{params:{user_id:l["getters"].getUserId(l["state"])}}).then((function(a){!0===a.data.success?(e.personalInformation.username=a.data.data[0].username,e.personalInformation.email=a.data.data[0].email,e.personalInformation.real_name=a.data.data[0].real_name,e.personalInformation.avatar=a.data.data[0].avatar,e.personalInformation.user_id=a.data.data[0].user_id):e.$message.error(a.data.message),e.loading=!1}))},logOff:function(){var e=this;this.$prompt("请输入原密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(a){var t=a.value;e.form_deleteUser.password=t,e.deleteUser()})).catch((function(){e.$message({type:"info",message:"取消注销"})}))},changePassword:function(){var e=this;this.$axios.post("/user/changePassword",r.a.stringify(this.form_changePassword)).then((function(a){!0===a.data.success?(e.$message.success(a.data.message),i["a"].logout(),i["a"].onLogout&&i["a"].onLogout()):e.$message.error(a.data.message)}))},handleAvatarSuccess:function(e,a){this.imageUrl=URL.createObjectURL(a.raw)}}},c=d,f=(t("db9e"),t("2877")),m=Object(f["a"])(c,s,o,!1,null,"16bb27ec",null);a["default"]=m.exports},afb0:function(e,a,t){},db9e:function(e,a,t){"use strict";t("afb0")}}]);